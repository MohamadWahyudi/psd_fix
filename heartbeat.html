
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Klasifikasi Normal dan Abnormal Heartbeat Menggunakan CNN 1D Berbasis CRISP-DM &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=073d7e8b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'heartbeat';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="KLASIFIKASI NAIVE BAYES" href="klasifikasi_naivebayes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fotop.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/fotop.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bisnis_understanding.html">Bisnis Understanding</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="data_understanding.html">Data Understanding</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="explorasi.html">Explorasi</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprosesing.html"><strong>Preprocessing</strong></a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="balancing_datasetEcoli.html">Penyeimbangan Dataset Ecoli</a></li>
<li class="toctree-l1"><a class="reference internal" href="klasifikasi_naivebayes.html">KLASIFIKASI NAIVE BAYES</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Klasifikasi Normal dan Abnormal Heartbeat Menggunakan CNN 1D Berbasis CRISP-DM</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fheartbeat.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/heartbeat.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Klasifikasi Normal dan Abnormal Heartbeat Menggunakan CNN 1D Berbasis CRISP-DM</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Klasifikasi Normal dan Abnormal Heartbeat Menggunakan CNN 1D Berbasis CRISP-DM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologi-penelitian-crisp-dm">Metodologi Penelitian: CRISP-DM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#business-understanding">1. Business Understanding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang-permasalahan">1.1 Latar Belakang Permasalahan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-bisnis">1.2 Tujuan Bisnis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-data-mining">1.3 Tujuan Data Mining</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">2. Data Understanding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sumber-dataset">2.1 Sumber Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bentuk-dan-representasi-data">2.2 Bentuk dan Representasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#karakteristik-dataset">2.3 Karakteristik Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kelas-target">2.4 Kelas Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pemahaman-masalah-data">2.5 Pemahaman Masalah Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-library-persiapan">Load Library + Persiapan</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">data understanding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#informasi-data">Informasi Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribusi-kelas">Distribusi Kelas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistik-deskriptif">Statistik Deskriptif</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heatmap-korelasi-sampling-300-fitur-untuk-menghindari-memoryerror">Heatmap Korelasi (Sampling 300 fitur untuk menghindari MemoryError)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data Preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-80-20-untuk-traintest">Split 80:20 untuk Train–Test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape-untuk-cnn">Reshape untuk CNN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-cnn">Modeling (CNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="klasifikasi-normal-dan-abnormal-heartbeat-menggunakan-cnn-1d-berbasis-crisp-dm">
<h1>Klasifikasi Normal dan Abnormal Heartbeat Menggunakan CNN 1D Berbasis CRISP-DM<a class="headerlink" href="#klasifikasi-normal-dan-abnormal-heartbeat-menggunakan-cnn-1d-berbasis-crisp-dm" title="Link to this heading">#</a></h1>
<section id="metodologi-penelitian-crisp-dm">
<h2>Metodologi Penelitian: CRISP-DM<a class="headerlink" href="#metodologi-penelitian-crisp-dm" title="Link to this heading">#</a></h2>
<p>Penelitian ini menggunakan metodologi CRISP-DM (Cross Industry Standard Process for Data Mining) yang terdiri dari enam tahapan utama, yaitu Business Understanding, Data Understanding, Data Preparation, Modeling, Evaluation, dan Deployment. Metodologi ini dipilih karena memberikan alur kerja yang sistematis dan terstruktur dalam pengembangan proyek data mining dan machine learning.</p>
</section>
<section id="business-understanding">
<h2>1. Business Understanding<a class="headerlink" href="#business-understanding" title="Link to this heading">#</a></h2>
<section id="latar-belakang-permasalahan">
<h3>1.1 Latar Belakang Permasalahan<a class="headerlink" href="#latar-belakang-permasalahan" title="Link to this heading">#</a></h3>
<p>Pada penelitian ini, fokus klasifikasi dibatasi pada dua kelas utama, yaitu
Normal dan Abnormal, sebagai bentuk skrining awal kondisi jantung. Pendekatan
ini relevan secara klinis karena pada tahap awal pemeriksaan, tenaga medis
perlu mengetahui apakah suara jantung pasien berada pada kondisi normal atau
menunjukkan kelainan.</p>
</section>
<section id="tujuan-bisnis">
<h3>1.2 Tujuan Bisnis<a class="headerlink" href="#tujuan-bisnis" title="Link to this heading">#</a></h3>
<p>Tujuan bisnis dari penelitian ini adalah membangun sistem klasifikasi suara jantung yang mampu mengidentifikasi kondisi heartbeat pasien secara otomatis dan akurat sebagai sistem pendukung keputusan awal.</p>
</section>
<section id="tujuan-data-mining">
<h3>1.3 Tujuan Data Mining<a class="headerlink" href="#tujuan-data-mining" title="Link to this heading">#</a></h3>
<p>Tujuan data mining dalam penelitian ini adalah:</p>
<p>Mempelajari karakteristik sinyal heartbeat berbasis time series</p>
<p>Membangun model klasifikasi berbasis deep learning</p>
<p>Mengevaluasi performa model dalam membedakan masing-masing kelas heartbeat</p>
</section>
</section>
<section id="data-understanding">
<h2>2. Data Understanding<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h2>
<section id="sumber-dataset">
<h3>2.1 Sumber Dataset<a class="headerlink" href="#sumber-dataset" title="Link to this heading">#</a></h3>
<p>Dataset yang digunakan dalam penelitian ini adalah Abnormal Heartbeat yang diperoleh dari Time Series Classification Repository (UCR). Dataset ini berasal dari rekaman suara jantung pasien yang dikumpulkan melalui aplikasi iStethoscope Pro (iPhone) dan uji klinis menggunakan stetoskop digital DigiScope.</p>
<p>Pada repository UCR, data tidak lagi disediakan dalam bentuk sinyal audio mentah, melainkan telah dikonversi menjadi representasi time series numerik untuk keperluan klasifikasi deret waktu.</p>
</section>
<section id="bentuk-dan-representasi-data">
<h3>2.2 Bentuk dan Representasi Data<a class="headerlink" href="#bentuk-dan-representasi-data" title="Link to this heading">#</a></h3>
<p>Setiap instance pada dataset merepresentasikan satu sinyal heartbeat dalam bentuk deret waktu amplitudo yang menunjukkan perubahan sinyal terhadap waktu selama proses pemeriksaan. Seluruh sinyal pada dataset telah melalui tahapan pra-pemrosesan sebelumnya, yaitu:</p>
<ul class="simple">
<li><p>Resampling ke frekuensi 4.000 Hz</p></li>
<li><p>Pemotongan (truncation) sehingga seluruh instance memiliki panjang sinyal yang sama
Dengan demikian, setiap data direpresentasikan sebagai vektor numerik dengan panjang yang konsisten dan tidak mengandung missing value.</p></li>
</ul>
</section>
<section id="karakteristik-dataset">
<h3>2.3 Karakteristik Dataset<a class="headerlink" href="#karakteristik-dataset" title="Link to this heading">#</a></h3>
<p>Karakteristik utama dataset Abnormal Heartbeat adalah sebagai berikut:</p>
<ul class="simple">
<li><p>Jumlah instance: 409 data</p></li>
<li><p>Panjang time series: 3.053 titik amplitudo</p></li>
<li><p>Tipe data: Numerik</p></li>
<li><p>Jenis data: Time series univariat</p></li>
<li><p>Format file: .ts dan .arff
Dataset ini termasuk dalam kategori time series classification</p></li>
</ul>
</section>
<section id="kelas-target">
<h3>2.4 Kelas Target<a class="headerlink" href="#kelas-target" title="Link to this heading">#</a></h3>
<p>Dataset Abnormal Heartbeat pada awalnya terdiri dari lima kelas heartbeat,
yaitu Artifact, ExtraStole, Murmur, Normal, dan ExtraHLS. Namun, pada penelitian
ini dilakukan penggabungan kelas untuk mendukung klasifikasi biner.</p>
<p>Pengelompokan kelas dilakukan sebagai berikut:</p>
<ul class="simple">
<li><p>Normal  → kelas 3 (Normal)</p></li>
<li><p>Abnormal → kelas 0 (Artifact), 1 (ExtraStole), 2 (Murmur), dan 4 (ExtraHLS)</p></li>
</ul>
<p>Dengan demikian, penelitian ini difokuskan pada klasifikasi Normal dan Abnormal
heartbeat.</p>
</section>
<section id="pemahaman-masalah-data">
<h3>2.5 Pemahaman Masalah Data<a class="headerlink" href="#pemahaman-masalah-data" title="Link to this heading">#</a></h3>
<p>Berdasarkan karakteristik dataset, permasalahan yang dihadapi merupakan klasifikasi multikelas berbasis time series. Karena data sudah berupa deret waktu numerik hasil pra-pemrosesan, maka penelitian ini tidak menggunakan ekstraksi fitur audio seperti MFCC. Sebagai gantinya, data time series akan diproses secara langsung menggunakan model Convolutional Neural Network 1 Dimensi (CNN 1D) yang mampu mempelajari pola temporal secara end-to-end.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="load-library-persiapan">
<h1>Load Library + Persiapan<a class="headerlink" href="#load-library-persiapan" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.utils.class_weight</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_class_weight</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Conv1D</span><span class="p">,</span> <span class="n">MaxPooling1D</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">BatchNormalization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">keras.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EarlyStopping</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.utils.class_weight</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_class_weight</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span> 
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Conv1D</span><span class="p">,</span> <span class="n">MaxPooling1D</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">BatchNormalization</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EarlyStopping</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tensorflow&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>data understanding<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;prepared_data/train_final.csv&quot;</span><span class="p">)</span>
<span class="n">df_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;prepared_data/valid_initial.csv&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Train Final:&quot;</span><span class="p">,</span> <span class="n">df_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train Final: (245, 18531)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>att1</th>
      <th>att2</th>
      <th>att3</th>
      <th>att4</th>
      <th>att5</th>
      <th>att6</th>
      <th>att7</th>
      <th>att8</th>
      <th>att9</th>
      <th>att10</th>
      <th>...</th>
      <th>att18522</th>
      <th>att18523</th>
      <th>att18524</th>
      <th>att18525</th>
      <th>att18526</th>
      <th>att18527</th>
      <th>att18528</th>
      <th>att18529</th>
      <th>att18530</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.020874</td>
      <td>-0.045197</td>
      <td>-0.043945</td>
      <td>-0.049011</td>
      <td>-0.046600</td>
      <td>-0.048004</td>
      <td>-0.045563</td>
      <td>-0.041962</td>
      <td>-0.037170</td>
      <td>-0.029541</td>
      <td>...</td>
      <td>-0.044037</td>
      <td>-0.041382</td>
      <td>-0.040192</td>
      <td>-0.036194</td>
      <td>-0.034424</td>
      <td>-0.032532</td>
      <td>-0.032501</td>
      <td>-0.031982</td>
      <td>-0.033783</td>
      <td>Abnormal</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.004303</td>
      <td>-0.009003</td>
      <td>-0.008728</td>
      <td>-0.009918</td>
      <td>-0.009949</td>
      <td>-0.010681</td>
      <td>-0.010773</td>
      <td>-0.011200</td>
      <td>-0.011230</td>
      <td>-0.011169</td>
      <td>...</td>
      <td>0.016815</td>
      <td>0.016846</td>
      <td>0.016754</td>
      <td>0.015839</td>
      <td>0.015930</td>
      <td>0.015961</td>
      <td>0.016205</td>
      <td>0.016357</td>
      <td>0.017792</td>
      <td>Abnormal</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.006073</td>
      <td>-0.012054</td>
      <td>-0.009979</td>
      <td>-0.010742</td>
      <td>-0.009888</td>
      <td>-0.010406</td>
      <td>-0.010101</td>
      <td>-0.009979</td>
      <td>-0.010162</td>
      <td>-0.010315</td>
      <td>...</td>
      <td>-0.006775</td>
      <td>0.001740</td>
      <td>0.010071</td>
      <td>0.017914</td>
      <td>0.025574</td>
      <td>0.032959</td>
      <td>0.039673</td>
      <td>0.044739</td>
      <td>0.050018</td>
      <td>Abnormal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.007202</td>
      <td>0.015594</td>
      <td>0.013245</td>
      <td>0.015594</td>
      <td>0.015015</td>
      <td>0.017792</td>
      <td>0.018250</td>
      <td>0.020660</td>
      <td>0.021240</td>
      <td>0.022797</td>
      <td>...</td>
      <td>0.040466</td>
      <td>0.037994</td>
      <td>0.036011</td>
      <td>0.033295</td>
      <td>0.032074</td>
      <td>0.030304</td>
      <td>0.030426</td>
      <td>0.030212</td>
      <td>0.031219</td>
      <td>Abnormal</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.024231</td>
      <td>-0.051056</td>
      <td>-0.045929</td>
      <td>-0.049835</td>
      <td>-0.048828</td>
      <td>-0.049316</td>
      <td>-0.048401</td>
      <td>-0.047913</td>
      <td>-0.046051</td>
      <td>-0.045837</td>
      <td>...</td>
      <td>-0.277618</td>
      <td>-0.294800</td>
      <td>-0.303314</td>
      <td>-0.309082</td>
      <td>-0.314179</td>
      <td>-0.310944</td>
      <td>-0.304504</td>
      <td>-0.298065</td>
      <td>-0.282532</td>
      <td>Abnormal</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 18531 columns</p>
</div></div></div>
</div>
<section id="informasi-data">
<h2>Informasi Data<a class="headerlink" href="#informasi-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 245 entries, 0 to 244
Columns: 18531 entries, att1 to target
dtypes: float64(18530), object(1)
memory usage: 34.6+ MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="distribusi-kelas">
<h2>Distribusi Kelas<a class="headerlink" href="#distribusi-kelas" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribusi Kelas&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a59c192cfad8bcde0a9675ee73cdd97308f2c28f8b1bf9a1e3eaf58aaf87174e.png" src="_images/a59c192cfad8bcde0a9675ee73cdd97308f2c28f8b1bf9a1e3eaf58aaf87174e.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>target
Abnormal    179
Normal       66
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="statistik-deskriptif">
<h2>Statistik Deskriptif<a class="headerlink" href="#statistik-deskriptif" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>att1</th>
      <td>245.0</td>
      <td>0.007396</td>
      <td>0.058230</td>
      <td>-0.100464</td>
      <td>-0.005798</td>
      <td>0.000519</td>
      <td>0.007202</td>
      <td>0.508087</td>
    </tr>
    <tr>
      <th>att2</th>
      <td>245.0</td>
      <td>0.011563</td>
      <td>0.126253</td>
      <td>-0.653076</td>
      <td>-0.011414</td>
      <td>0.001160</td>
      <td>0.014374</td>
      <td>0.999969</td>
    </tr>
    <tr>
      <th>att3</th>
      <td>245.0</td>
      <td>0.010803</td>
      <td>0.110283</td>
      <td>-0.577881</td>
      <td>-0.009766</td>
      <td>0.001312</td>
      <td>0.013245</td>
      <td>0.887634</td>
    </tr>
    <tr>
      <th>att4</th>
      <td>245.0</td>
      <td>0.012401</td>
      <td>0.111660</td>
      <td>-0.361969</td>
      <td>-0.011200</td>
      <td>0.001984</td>
      <td>0.013886</td>
      <td>0.943298</td>
    </tr>
    <tr>
      <th>att5</th>
      <td>245.0</td>
      <td>0.008873</td>
      <td>0.102370</td>
      <td>-0.336578</td>
      <td>-0.011444</td>
      <td>0.001740</td>
      <td>0.011841</td>
      <td>0.844208</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>att18526</th>
      <td>245.0</td>
      <td>0.003977</td>
      <td>0.053847</td>
      <td>-0.314179</td>
      <td>-0.008453</td>
      <td>-0.000458</td>
      <td>0.015625</td>
      <td>0.356995</td>
    </tr>
    <tr>
      <th>att18527</th>
      <td>245.0</td>
      <td>0.003362</td>
      <td>0.053838</td>
      <td>-0.310944</td>
      <td>-0.009369</td>
      <td>-0.000244</td>
      <td>0.014496</td>
      <td>0.357971</td>
    </tr>
    <tr>
      <th>att18528</th>
      <td>245.0</td>
      <td>0.002771</td>
      <td>0.054147</td>
      <td>-0.314697</td>
      <td>-0.009583</td>
      <td>-0.000336</td>
      <td>0.013184</td>
      <td>0.356659</td>
    </tr>
    <tr>
      <th>att18529</th>
      <td>245.0</td>
      <td>0.001474</td>
      <td>0.056842</td>
      <td>-0.355682</td>
      <td>-0.009552</td>
      <td>-0.000610</td>
      <td>0.012085</td>
      <td>0.353302</td>
    </tr>
    <tr>
      <th>att18530</th>
      <td>245.0</td>
      <td>0.000159</td>
      <td>0.060605</td>
      <td>-0.428650</td>
      <td>-0.009338</td>
      <td>-0.000336</td>
      <td>0.012726</td>
      <td>0.348450</td>
    </tr>
  </tbody>
</table>
<p>18530 rows × 8 columns</p>
</div></div></div>
</div>
</section>
<section id="heatmap-korelasi-sampling-300-fitur-untuk-menghindari-memoryerror">
<h2>Heatmap Korelasi (Sampling 300 fitur untuk menghindari MemoryError)<a class="headerlink" href="#heatmap-korelasi-sampling-300-fitur-untuk-menghindari-memoryerror" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampled_features</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">sampled_features</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Heatmap Korelasi (300 Fitur Sample)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1bac0c54950cfd3e40429e823ef5be35f2f684c52bb9beb13d6f3df4467bc7a3.png" src="_images/1bac0c54950cfd3e40429e823ef5be35f2f684c52bb9beb13d6f3df4467bc7a3.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-preparation">
<h1>Data Preparation<a class="headerlink" href="#data-preparation" title="Link to this heading">#</a></h1>
<section id="split-80-20-untuk-traintest">
<h2>Split 80:20 untuk Train–Test<a class="headerlink" href="#split-80-20-untuk-traintest" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((196, 18530), (49, 18530))
</pre></div>
</div>
</div>
</div>
</section>
<section id="scaling">
<h2>Scaling<a class="headerlink" href="#scaling" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">X_valid_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_valid</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]))</span>

<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="s2">&quot;scaler.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;scaler.pkl&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="reshape-untuk-cnn">
<h2>Reshape untuk CNN<a class="headerlink" href="#reshape-untuk-cnn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_cnn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test_cnn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_valid_cnn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">X_valid_scaled</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">y_train_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_test_cat</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_valid_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_valid</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span>

<span class="n">X_train_cnn</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(196, 18530, 1)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modeling-cnn">
<h1>Modeling (CNN)<a class="headerlink" href="#modeling-cnn" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">GlobalAveragePooling1D</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
    <span class="n">Conv1D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train_cnn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
    <span class="n">BatchNormalization</span><span class="p">(),</span>
    <span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>

    <span class="n">Conv1D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">BatchNormalization</span><span class="p">(),</span>
    <span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>

    <span class="n">Conv1D</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">BatchNormalization</span><span class="p">(),</span>

    <span class="c1"># Ganti Flatten() dengan GlobalAveragePooling1D()</span>
    <span class="n">GlobalAveragePooling1D</span><span class="p">(),</span> <span class="c1"># Outputnya hanya 128 (sama dengan jumlah filter terakhir)</span>
    <span class="c1"># Tidak perlu Dropout karena sudah ada Global Pooling</span>
    
    <span class="c1"># Dense Layer sekarang hanya perlu mengalokasikan (128, 2)</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\Asus\miniconda3\envs\psd\Lib\site-packages\keras\src\layers\convolutional\base_conv.py:113: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">class_weights_new</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Bobot Kelas 0 (Mayoritas) = 1.0 (bobot standar)</span>
    <span class="mi">0</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> 
    <span class="c1"># Bobot Kelas 1 (Minoritas) = Rasio (2.77) atau sedikit lebih rendah</span>
    <span class="mi">1</span><span class="p">:</span> <span class="mf">1.8</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<section id="training">
<h2>Training<a class="headerlink" href="#training" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">early</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train_cnn</span><span class="p">,</span> <span class="n">y_train_cat</span><span class="p">,</span>
    <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test_cnn</span><span class="p">,</span> <span class="n">y_test_cat</span><span class="p">),</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early</span><span class="p">],</span>
    <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weights_new</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">46s</span> 3s/step - accuracy: 0.7296 - loss: 0.6218 - val_accuracy: 0.7347 - val_loss: 0.6294
Epoch 2/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">67s</span> 2s/step - accuracy: 0.7347 - loss: 0.6495 - val_accuracy: 0.7551 - val_loss: 0.6066
Epoch 3/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">32s</span> 2s/step - accuracy: 0.7653 - loss: 0.6439 - val_accuracy: 0.7551 - val_loss: 0.6393
Epoch 4/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">53s</span> 3s/step - accuracy: 0.7398 - loss: 0.6183 - val_accuracy: 0.7143 - val_loss: 0.6293
Epoch 5/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">34s</span> 3s/step - accuracy: 0.7296 - loss: 0.6208 - val_accuracy: 0.7959 - val_loss: 0.5936
Epoch 6/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">61s</span> 5s/step - accuracy: 0.7704 - loss: 0.6322 - val_accuracy: 0.7551 - val_loss: 0.5862
Epoch 7/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">38s</span> 3s/step - accuracy: 0.7959 - loss: 0.5919 - val_accuracy: 0.7551 - val_loss: 0.6307
Epoch 8/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">39s</span> 3s/step - accuracy: 0.7602 - loss: 0.6368 - val_accuracy: 0.7551 - val_loss: 0.8039
Epoch 9/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">39s</span> 3s/step - accuracy: 0.7398 - loss: 0.6206 - val_accuracy: 0.7551 - val_loss: 0.7929
Epoch 10/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">35s</span> 3s/step - accuracy: 0.7398 - loss: 0.6319 - val_accuracy: 0.7347 - val_loss: 0.7617
Epoch 11/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">34s</span> 2s/step - accuracy: 0.7908 - loss: 0.5883 - val_accuracy: 0.7347 - val_loss: 0.6111
Epoch 12/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">34s</span> 3s/step - accuracy: 0.7653 - loss: 0.6210 - val_accuracy: 0.7551 - val_loss: 0.7958
Epoch 13/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">42s</span> 3s/step - accuracy: 0.7500 - loss: 0.5938 - val_accuracy: 0.7551 - val_loss: 0.8692
Epoch 14/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">39s</span> 3s/step - accuracy: 0.8112 - loss: 0.5993 - val_accuracy: 0.7551 - val_loss: 0.7088
Epoch 15/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">36s</span> 3s/step - accuracy: 0.7602 - loss: 0.6170 - val_accuracy: 0.7347 - val_loss: 0.6037
Epoch 16/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">41s</span> 3s/step - accuracy: 0.7908 - loss: 0.6058 - val_accuracy: 0.7755 - val_loss: 0.5826
Epoch 17/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">33s</span> 2s/step - accuracy: 0.7755 - loss: 0.5686 - val_accuracy: 0.7347 - val_loss: 0.5718
Epoch 18/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">47s</span> 3s/step - accuracy: 0.7908 - loss: 0.5919 - val_accuracy: 0.7755 - val_loss: 0.5944
Epoch 19/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">28s</span> 2s/step - accuracy: 0.7347 - loss: 0.6318 - val_accuracy: 0.7755 - val_loss: 0.6234
Epoch 20/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">49s</span> 3s/step - accuracy: 0.7551 - loss: 0.5910 - val_accuracy: 0.6939 - val_loss: 0.5942
Epoch 21/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">50s</span> 3s/step - accuracy: 0.7653 - loss: 0.6093 - val_accuracy: 0.7347 - val_loss: 0.5964
Epoch 22/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">39s</span> 3s/step - accuracy: 0.7704 - loss: 0.6212 - val_accuracy: 0.7551 - val_loss: 0.6668
Epoch 23/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">43s</span> 3s/step - accuracy: 0.7551 - loss: 0.6442 - val_accuracy: 0.2653 - val_loss: 2.5911
Epoch 24/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">84s</span> 3s/step - accuracy: 0.7500 - loss: 0.6051 - val_accuracy: 0.2653 - val_loss: 2.9197
Epoch 25/25
<span class=" -Color -Color-Bold">13/13</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">37s</span> 3s/step - accuracy: 0.7449 - loss: 0.6556 - val_accuracy: 0.4286 - val_loss: 1.1489
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test_cnn</span><span class="p">,</span> <span class="n">y_test_cat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Accuracy:&quot;</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test Loss:&quot;</span><span class="p">,</span> <span class="n">test_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 552ms/step - accuracy: 0.7347 - loss: 0.5718
Test Accuracy: 0.7346938848495483
Test Loss: 0.5718379616737366
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_cnn</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_test_cat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">6s</span> 5s/step  
</pre></div>
</div>
<img alt="_images/6fbff4319a10cc2957cfb7e96ac245aef4357708b4005cb04bab7b18a7483048.png" src="_images/6fbff4319a10cc2957cfb7e96ac245aef4357708b4005cb04bab7b18a7483048.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

           0       0.77      0.92      0.84        36
           1       0.50      0.23      0.32        13

    accuracy                           0.73        49
   macro avg       0.63      0.57      0.58        49
weighted avg       0.70      0.73      0.70        49
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pastikan Anda telah mengimpor joblib: import joblib</span>
<span class="c1"># Model</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;cnn_abnormal_heartbeat.h5&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model CNN berhasil disimpan sebagai cnn_abnormal_heartbeat.h5&quot;</span><span class="p">)</span>

<span class="c1"># Scaler (asumsi objek scaler Anda bernama &#39;scaler&#39;)</span>
<span class="c1"># Kode ini harus ditambahkan setelah objek &#39;scaler&#39; diinisialisasi dan di-fit/transform.</span>
<span class="c1"># Karena scaler digunakan di app.py, ini juga harus disimpan.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Asumsi objek scaler yang digunakan sebelumnya bernama &#39;scaler&#39;</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="s2">&quot;scaler.pkl&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scaler berhasil disimpan sebagai scaler.pkl&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pastikan variabel &#39;scaler&#39; sudah terdefinisi dan fit dengan data.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save(&#39;my_model.keras&#39;)` or `keras.saving.save_model(model, &#39;my_model.keras&#39;)`. 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model CNN berhasil disimpan sebagai cnn_abnormal_heartbeat.h5
Scaler berhasil disimpan sebagai scaler.pkl
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;val_accuracy&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span><span class="s2">&quot;Validation&quot;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;val_loss&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span><span class="s2">&quot;Validation&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/356ce59fa747d2783d849e8621d0d4d36d431e1ad1124f50914f49a5f57f4b51.png" src="_images/356ce59fa747d2783d849e8621d0d4d36d431e1ad1124f50914f49a5f57f4b51.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> app.py
<span class="o">%%</span><span class="n">writefile</span> <span class="n">app</span><span class="o">.</span><span class="n">py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">streamlit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringIO</span>

<span class="c1"># Panjang sinyal yang digunakan di training (berdasarkan kolom att1 hingga att18530)</span>
<span class="n">EXPECTED_LENGTH</span> <span class="o">=</span> <span class="mi">18530</span> 
<span class="n">TARGET_CLASSES</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Abnormal&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Normal&quot;</span><span class="p">}</span>

<span class="n">st</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Abnormal Heartbeat Classification&quot;</span><span class="p">)</span>

<span class="c1"># --- 1. Memuat Model dan Scaler ---</span>
<span class="nd">@st</span><span class="o">.</span><span class="n">cache_resource</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_resources</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;cnn_abnormal_heartbeat.h5&quot;</span><span class="p">)</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;scaler.pkl&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error: Pastikan file &#39;cnn_abnormal_heartbeat.h5&#39; dan &#39;scaler.pkl&#39; ada di direktori yang sama.&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error saat memuat sumber daya: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="n">model</span><span class="p">,</span> <span class="n">scaler</span> <span class="o">=</span> <span class="n">load_resources</span><span class="p">()</span>

<span class="c1"># --- 2. Input Data ---</span>
<span class="n">st</span><span class="o">.</span><span class="n">header</span><span class="p">(</span><span class="s2">&quot;Pilih Metode Input Data&quot;</span><span class="p">)</span>
<span class="n">input_method</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span>
    <span class="s2">&quot;Pilih cara Anda ingin memasukkan data:&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="s1">&#39;Unggah File CSV&#39;</span><span class="p">,</span> <span class="s1">&#39;Input Data Manual (Paste CSV)&#39;</span><span class="p">),</span>
    <span class="n">index</span><span class="o">=</span><span class="mi">0</span> 
<span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">input_method</span> <span class="o">==</span> <span class="s1">&#39;Unggah File CSV&#39;</span><span class="p">:</span>
    <span class="n">uploaded</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">file_uploader</span><span class="p">(</span><span class="s2">&quot;Unggah File CSV (1 sampel heartbeat)&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">uploaded</span><span class="p">:</span>
        <span class="c1"># Asumsi CSV tanpa header (hanya nilai sinyal)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">uploaded</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> 
        <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;File berhasil diunggah.&quot;</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">input_method</span> <span class="o">==</span> <span class="s1">&#39;Input Data Manual (Paste CSV)&#39;</span><span class="p">:</span>
    <span class="n">st</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Tempelkan data numerik sinyal heartbeat Anda di bawah ini, dipisahkan oleh koma, baris baru, atau spasi.&quot;</span><span class="p">)</span>
    
    <span class="n">text_input</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_area</span><span class="p">(</span>
        <span class="s2">&quot;Input Data CSV Mentah (misal: 0.1, 0.2, 0.3, ...)&quot;</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">200</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">text_input</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Fleksibel membaca pemisah (koma, spasi, atau baris baru)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">text_input</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s*,\s*|\s+&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data berhasil diproses. Ditemukan </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> nilai.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error dalam memproses data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- 3. Proses Prediksi ---</span>
<span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    
    <span class="c1"># 3a. Data Preparation &amp; Flattening</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
    <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Flatten data menjadi satu baris (sample)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Data diinterpretasikan sebagai multiple baris. Data akan di-flatten menjadi satu sampel.&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">T</span>
        
    <span class="c1"># 3b. Validasi Panjang</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">EXPECTED_LENGTH</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Panjang sinyal (</span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) tidak sesuai dengan panjang yang diharapkan (</span><span class="si">{</span><span class="n">EXPECTED_LENGTH</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        
    <span class="n">st</span><span class="o">.</span><span class="n">subheader</span><span class="p">(</span><span class="s2">&quot;Hasil Analisis&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Panjang Sinyal: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 3c. Scaling Data</span>
        <span class="n">scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> 

        <span class="c1"># 3d. Reshaping untuk CNN (dari (1, L) menjadi (1, L, 1))</span>
        <span class="n">reshaped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">scaled</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># 3e. Prediksi</span>
        <span class="k">with</span> <span class="n">st</span><span class="o">.</span><span class="n">spinner</span><span class="p">(</span><span class="s1">&#39;Melakukan Klasifikasi...&#39;</span><span class="p">):</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">reshaped</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
            
            <span class="c1"># Indeks 0 = Abnormal, Indeks 1 = Normal</span>
            <span class="n">prob_abnormal</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> 
            <span class="n">prob_normal</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>   

        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="s2">&quot;---&quot;</span><span class="p">)</span>
        
        <span class="c1"># 3f. Menampilkan Hasil dengan Logika yang BENAR (0=Abnormal)</span>
        <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">TARGET_CLASSES</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">predicted_class</span> <span class="o">==</span> <span class="s2">&quot;Normal&quot;</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;## 🟢 Prediksi: </span><span class="si">{</span><span class="n">predicted_class</span><span class="si">}</span><span class="s2"> (Keyakinan: </span><span class="si">{</span><span class="n">prob_normal</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;## 🔴 Prediksi: </span><span class="si">{</span><span class="n">predicted_class</span><span class="si">}</span><span class="s2"> (Keyakinan: </span><span class="si">{</span><span class="n">prob_abnormal</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

        <span class="c1"># Menampilkan probabilitas detail</span>
        <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**Probabilitas:**&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Normal: </span><span class="si">{</span><span class="n">prob_normal</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Abnormal: </span><span class="si">{</span><span class="n">prob_abnormal</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">st</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Terjadi error saat prediksi: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Pastikan data sudah benar dan scaler.pkl cocok dengan data input.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting app.py
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="klasifikasi_naivebayes.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">KLASIFIKASI NAIVE BAYES</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Klasifikasi Normal dan Abnormal Heartbeat Menggunakan CNN 1D Berbasis CRISP-DM</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologi-penelitian-crisp-dm">Metodologi Penelitian: CRISP-DM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#business-understanding">1. Business Understanding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang-permasalahan">1.1 Latar Belakang Permasalahan</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-bisnis">1.2 Tujuan Bisnis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan-data-mining">1.3 Tujuan Data Mining</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">2. Data Understanding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sumber-dataset">2.1 Sumber Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bentuk-dan-representasi-data">2.2 Bentuk dan Representasi Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#karakteristik-dataset">2.3 Karakteristik Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kelas-target">2.4 Kelas Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pemahaman-masalah-data">2.5 Pemahaman Masalah Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-library-persiapan">Load Library + Persiapan</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">data understanding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#informasi-data">Informasi Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribusi-kelas">Distribusi Kelas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistik-deskriptif">Statistik Deskriptif</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heatmap-korelasi-sampling-300-fitur-untuk-menghindari-memoryerror">Heatmap Korelasi (Sampling 300 fitur untuk menghindari MemoryError)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data Preparation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-80-20-untuk-traintest">Split 80:20 untuk Train–Test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reshape-untuk-cnn">Reshape untuk CNN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-cnn">Modeling (CNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>